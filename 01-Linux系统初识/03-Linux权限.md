## 三 权限

#### 3.1 权限简介

Linux是一个支持多用户、多任务的操作系统（windows并不是真正的多任务）。在Unix/Linux安装的过程中，系统会自动创建许多用户账号，而这些默认的用户就称为“标准用户”。Unix/Linux系统中的root账号通常用于系统的维护和管理，它对Unix/Linux操作系统的所有部分具有不受限制的访问权限。在大多数版本的Unix/Linux中，都不推荐直接使用root账号登录系统。  


用户能够控制一个给定的文件或目录的访问程度，一个文件或目录可能有读、写及执行权限：   
- 读权限（r） 对文件而言，具有读取文件内容的权限；对目录来说，具有浏览目录的权限。
- 写权限（w） 对文件而言，具有新增、修改文件内容的权限；对目录来说，具有删除、移动目录内文件的权限。
- 可执行权限（x） 对文件而言，具有执行文件的权限；对目录了来说该用户具有进入目录的权限。


第1个字母代表文件的类型，后 9 个字母分别代表三组权限：文件所有者、用户者、其他用户拥有的权限：
- d： 代表文件夹
- -： 代表普通文件
- c： 代表硬件字符设备
- b： 代表硬件块设备
- s： 表示管道文件
- l： 代表软链接文件。 

每一个用户都有它自身的读、写和执行权限：
- 第一组权限控制访问自己的文件权限，即所有者权限。
- 第二组权限控制用户组访问其中一个用户的文件的权限。
- 第三组权限控制其他所有用户访问一个用户的文件的权限。
- 这三组权限赋予用户不同类型（即所有者、用户组和其他用户）的读、写及执行权限就构成了一个有9种类型的权限组。

#### 3.2 用户相关命令

- whoami：查看当前用户，可通过cat /etc/passwd查看系统用户信息
- who：查看登录用户
  - -m或am I		只显示运行who命令的用户名、登录终端和登录时间
  - -q或--count		只显示用户的登录账号和登录用户的数量
  - -u或--heading	显示列标题
- su： 切换到某个用户，示例：`su root`， 如果是`su - root`则不但会切换到root用户，还会切换到目录`/root`
- sudo：获取管理员权限
- exit：退出登录账户 
- useradd：添加用户，使用方式`useradd [参数] 新建用户账号`
  - -d：指定用户登录系统时的主目录，如果不使用该参数，系统自动在/home目录下建立与用户名同名目录为主目录
  - -m：自动建立目录
  - -g：指定组名称
- userdel abc(用户名)		删除abc用户，但不会自动删除用户的主目录
- userdel -r abc(用户名)	删除用户，同时删除用户的主目录

useradd示例：
```
sudo useradd XX -m -d /home/YY      # 创建一个XX用户，自动建立目录，且目录为home下的YY  
useradd -d /home/abc abc -m	        # 创建abc用户，如果/home/abc目录不存在，就自动创建这个目录，同时用户属于abc组
useradd -d /home/a a -g test -m	    # 创建一个用户名字叫a，主目录在/home/a，如果主目录不存在，就自动创建主目录，同时用户属于test组
```


查看有哪些用户组:
- 方法一:cat /etc/group
- 方法二:groupmod +三次tab键

添加删除组 groupadd、groupdel
- groupadd 	新建组账号 
- groupdel 	组账号

注意：添加账户时，如果没有指定组，那么会自动创建一个和用户名相同的用户组。创建账户并添加组：`useradd xx -m -d /home/xx -g 组名`

查看修改用户所在组 usermod：
- 查看用户所在组：	group 用户名
- 修改用户所在组：	usermod -g 用户组 用户名

新创建的用户，默认不能sudo，需要进行以下操作：
```
# -g 用来制定这个用户默认的用户组  -G 一般配合'-a'来完成向其它组添加
sudo usermod -a -G adm 用户名
sudo usermod -a -G sudo 用户名
```

#### 3.3 权限命令

文件的左侧有文件权限展示，例如：
```
drwxr-xr-x 2 ruyue ruyue 4096
drwxr：	文件拥有者的权限，即第一个ruyue的权限
xr：	文件所属组的权限，即第二个ruyue的权限
x：		其他人的权限
```


修改文件权限 `chmod u/g/o/a +/-/= rwx 文件`:
```
chmod u+x test.txt				    文件拥有者添加执行权限
chmod u=rw,g=x,o=r	test.txt		同时分配不同权限 chmod u=,g=,o= 1.txt
```

贴士：
- r的数字代号是4，w是2，x是1，-是0，上述命令可以用数字代替
- 如果想递归所有目录加上相同权限，需要加上参数“ -R ”，如： `chmod 777 test/ -R 递归 test 目录下所有文件加 777 权限`
示例：

其他命令：
- 修改文件所有者 chown：`chown 用户名 test.txt`
- 修改文件用户组 chgrp：`sudo chgrp 用户组 test.txt`
