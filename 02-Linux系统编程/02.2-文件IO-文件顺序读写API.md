## 一 文件按顺序读/写

#### 1.1 按照字符读写文件fgetc、fputc

按照字符读写文件的库函数，即从文件中读/写一个字符：
```c
#include <stdio.h>
#include <string.h> 

int main() {

    // 获取文件指针
    FILE *fp = NULL;
    fp = fopen("test.txt", "r+");
    if (fp == NULL) {
        perror("open");
        fclose(fp);
		return -1;
    }

    // fputc写入文件内容，将原文件内容全部覆盖：成功则返回写入文件的字符，失败返回 -1 
    char buf[] = "hello";
    int i = 0;
    int len = strlen(buf);
    for (i = 0; i < len; i++ ) {
        int ch = fputc(buf[i], fp); 
        if (ch == -1) {                
            printf("写入失败 \n");
            break;
        }
    }

    // fgetc读取文件内容：成功则返回读取到的字符，失败返回-1
    printf("写入文件内容是：\n");
    int c;
    while((c = fgetc(fp)) != EOF) {
        printf("%c", c);
    }

    fclose(fp);
    return 0;
}
```

#### 1.2 按照行读写文件fgets、fputs

示例：
```c
#include <stdio.h>
#include <string.h> 

int main() {

    // 获取文件指针
    FILE *fp = NULL;
    fp = fopen("test.txt", "r+");
    if (fp == NULL) {
        perror("open");
        fclose(fp);
		return -1;
    }

    // fputs写入文件内容
    char *buf[] = {"hello\n", "world!\n"};
    int i = 0;
    for (i = 0; i < 2; i++ ) {
        int len = fputs(buf[i], fp); 
        if (len == -1) {                 // 失败返回 -1 
            printf("写入失败 \n");
            break;
        }
         printf("写入文件的长度为：%d\n", len);
    }
   
    // 将文件内部的位置指针重新指向一个流
    rewind(fp);

    // fgets读取文件内容
    char str[100];
    while ( !feof(fp) ){
        char *p = fgets(str, sizeof(str), fp);
        if (p != NULL) {
            printf("str = %s", str);
        }
    }
    
    fclose(fp);
    return 0;
}
```

#### 1.3 按照格式化文件fprintf、fscanf

写文件：
```c
#include <stdio.h>
int fprintf(FILE * stream, const char * format, ...);
功能：根据参数format字符串来转换并格式化数据，然后将结果输出到stream指定的文件中，指定出现字符串结束符 '\0'  为止。
参数：
	stream：已经打开的文件
	format：字符串格式，用法和printf()一样
返回值：
	成功：实际写入文件的字符个数
	失败：-1
示例：
fprintf(fp, "%d %d %d\n", 1, 2, 3);
```

读文件：
```c
#include <stdio.h>
int fscanf(FILE * stream, const char * format, ...);
功能：从stream指定的文件读取字符串，并根据参数format字符串来转换并格式化数据。
参数：
	stream：已经打开的文件
	format：字符串格式，用法和scanf()一样
返回值：
	成功：参数数目，成功转换的值的个数
	失败： - 1
示例：
int a = 0;
int b = 0;
int c = 0;
fscanf(fp, "%d %d %d\n", &a, &b, &c);
printf("a = %d, b = %d, c = %d\n", a, b, c);
```

#### 1.4 按照块读写文件fread、fwrite

写入函数：
```c
size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream);
功能：以数据块的方式给文件写入内容
参数：
	ptr：准备写入文件数据的地址
	size： size_t 为 unsigned int类型，此参数指定写入文件内容的块数据大小
	nmemb：写入文件的块数，写入文件数据总大小为：size * nmemb
	stream：已经打开的文件指针
返回值：
	成功：实际成功写入文件数据的块数目，此值和 nmemb 相等
	失败：0
```

读取哈数：
```c
size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);
功能：以数据块的方式从文件中读取内容
参数：
	ptr：存放读取出来数据的内存空间
	size： size_t 为 unsigned int类型，此参数指定读取文件内容的块数据大小
	nmemb：读取文件的块数，读取文件数据总大小为：size * nmemb
	stream：已经打开的文件指针
返回值：
	成功：实际成功读取到内容的块数，如果此值比nmemb小，但大于0，说明读到文件的结尾。
	失败：0
	0: 表示读到文件结尾。(feof())
```

示例：
```c
#include <stdio.h>
#include <string.h> 

typedef struct Stu {
    char name[50];
    int id;
}Stu;

int main() {

    // 获取文件指针
    FILE *fp = NULL;
    fp = fopen("test.txt", "r+");
    if (fp == NULL) {
        perror("open");
        fclose(fp);
		return -1;
    }

    // 写入内容
    Stu s[3];
    int i = 0;
    for (i = 0; i < 3; i++) {
        sprintf(s[i].name, "stu%d%d%d", i, i, i);
        s[i].id = i + 1;
    }

    int ret = fwrite(s, sizeof(Stu), 3, fp);
    printf("ret = %d\n", ret);
   
    // 将文件内部的位置指针重新指向一个流
    rewind(fp);

    // 读取文件内容
    int retR = fread(s, sizeof(Stu), 3, fp);
    int j = 0;
    for (i = 0; j < 3; j++) {
        printf("s = %s, %d\n", s[j].name, s[j].id);
    }
    
    fclose(fp);
    return 0;
}
```